!function(t,e){"object"==typeof module&&"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define([],e):t.httpVueLoader=e()}(this,function(){"use strict";let t=0;function e(t,e){this.component=t,this.elt=e}function n(t,e){this.component=t,this.elt=e,this.module={exports:{}}}function s(t,e){this.component=t,this.elt=e}function o(t){this.name=t,this.template=null,this.script=null,this.styles=[],this._scopeId=""}function i(t){return t}function r(t){const e=t.match(/(.*?)([^\/]+?)\/?(\.vue)?(\?.*|#.*|$)/);return{name:e[2],url:e[1]+e[2]+(void 0===e[3]?"/index.vue":e[3])+e[4]}}function l(t,e){return"./"===e.substr(0,2)||"../"===e.substr(0,3)?t+e:e}function c(t,e){const n=r(t);return c.load(n.url,e)}return e.prototype={withBase(t){let e;if(this.component.baseURI){(e=document.createElement("base")).href=this.component.baseURI;const t=this.component.getHead();t.insertBefore(e,t.firstChild)}t.call(this),e&&this.component.getHead().removeChild(e)},scopeStyles(t,e){function n(t){const n=[];return t.selectorText.split(/\s*,\s*/).forEach(function(t){n.push(e+" "+t);const s=t.match(/([^ :]+)(.+)?/);n.push(s[1]+e+(s[2]||""))}),n.join(",")+t.cssText.substr(t.selectorText.length)}function s(){const e=t.sheet,s=e.cssRules;for(let t=0;t<s.length;++t){const o=s[t];if(1===o.type)e.deleteRule(t),e.insertRule(n(o),t);else if(4===o.type){let s="";for(let t=0;t<o.cssRules.length;++t){const e=o.cssRules[t];1===e.type&&(s+=n(e))}const i="@media "+o.conditionText+"{"+s+"}";e.deleteRule(t),e.insertRule(i,t)}}}try{s()}catch(e){if(e instanceof DOMException&&e.code===DOMException.INVALID_ACCESS_ERR)return t.sheet.disabled=!0,void t.addEventListener("load",function e(){t.removeEventListener("load",e),setTimeout(function(){s(),t.sheet.disabled=!1})});throw e}},compile(){const t=null!==this.template,e=this.elt.hasAttribute("scoped"),n=this.elt.hasAttribute("scoped-inside");if(n){if(!t)return;this.elt.removeAttribute("scoped")}else if(e){if(!t)return;this.elt.removeAttribute("scoped")}return this.withBase(function(){this.component.getHead().appendChild(this.elt)}),n?this.scopeStyles(this.elt,"["+this.component.getScopeId()+"]"):e&&this.scopeStyles(this.elt,"["+this.component.getScopeId()+"]"),Promise.resolve()},getContent(){return this.elt.textContent},setContent(t){this.withBase(function(){this.elt.textContent=t})}},n.prototype={getContent(){return this.elt.textContent},setContent(t){this.elt.textContent=t},compile(t){const e=function(t){return c.require(l(this.component.baseURI,t))}.bind(this),n=function(t,e){return c(l(this.component.baseURI,t),e)}.bind(this);try{Function("exports","require","httpVueLoader","module",this.getContent()).call(this.module.exports,this.module.exports,e,n,this.module)}catch(t){if(!("lineNumber"in t))return Promise.reject(t);const e=responseText.replace(/\r?\n/g,"\n"),n=e.substr(0,e.indexOf(script)).split("\n").length+t.lineNumber-1;throw new t.constructor(t.message,url,n)}return Promise.resolve(this.module.exports).then(c.scriptExportsHandler.bind(this)).then(function(t){this.module.exports=t}.bind(this))}},s.prototype={getContent(){return this.elt.innerHTML},setContent(t){this.elt.innerHTML=t},getRootElt(){let t=this.elt.content||this.elt;if("firstElementChild"in t)return t.firstElementChild;for(t=t.firstChild;null!==t;t=t.nextSibling)if(t.nodeType===Node.ELEMENT_NODE)return t;return null},compile:()=>Promise.resolve()},o.prototype={getHead:()=>document.head||document.getElementsByTagName("head")[0],getScopeId(){return""===this._scopeId&&(this._scopeId="data-s-"+(t++).toString(36),this.template.getRootElt().setAttribute(this._scopeId,"")),this._scopeId},load(t){return c.httpRequest(t).then(function(o){this.baseURI=t.substr(0,t.lastIndexOf("/")+1);const i=document.implementation.createHTMLDocument("");i.body.innerHTML=(this.baseURI?'<base href="'+this.baseURI+'">':"")+o;for(let t=i.body.firstChild;t;t=t.nextSibling)switch(t.nodeName){case"TEMPLATE":this.template=new s(this,t);break;case"SCRIPT":this.script=new n(this,t);break;case"STYLE":this.styles.push(new e(this,t))}return this}.bind(this))},_normalizeSection(t){let e;return(e=null!==t&&t.elt.hasAttribute("src")?c.httpRequest(t.elt.getAttribute("src")).then(function(e){return t.elt.removeAttribute("src"),e}):Promise.resolve(null)).then(function(e){if(null!==t&&t.elt.hasAttribute("lang")){const n=t.elt.getAttribute("lang");return t.elt.removeAttribute("lang"),c.langProcessor[n.toLowerCase()].call(this,null===e?t.getContent():e)}return e}.bind(this)).then(function(e){null!==e&&t.setContent(e)})},normalize(){return Promise.all(Array.prototype.concat(this._normalizeSection(this.template),this._normalizeSection(this.script),this.styles.map(this._normalizeSection))).then(function(){return this}.bind(this))},compile(){return Promise.all(Array.prototype.concat(this.template&&this.template.compile(),this.script&&this.script.compile(),this.styles.map(function(t){return t.compile()}))).then(function(){return this}.bind(this))}},c.load=function(t,e){return function(){return new o(e).load(t).then(function(t){return t.normalize()}).then(function(t){return t.compile()}).then(function(t){const e=null!==t.script?t.script.module.exports:{};return null!==t.template&&(e.template=t.template.getContent()),void 0===e.name&&void 0!==t.name&&(e.name=t.name),e._baseURI=t.baseURI,e})}},c.register=function(t,e){const n=r(e);t.component(n.name,c.load(n.url))},c.install=function(t){t.mixin({beforeCreate(){const e=this.$options.components;for(let n in e)if("string"==typeof e[n]&&"url:"===e[n].substr(0,4)){const s=r(e[n].substr(4)),o="_baseURI"in this.$options?l(this.$options._baseURI,s.url):s.url;isNaN(n)?e[n]=c.load(o,n):e[n]=t.component(s.name,c.load(o,s.name))}}})},c.require=function(t){return window[t]},c.httpRequest=function(t){return new Promise(function(e,n){const s=new URL(t,document.URL),o=new XMLHttpRequest;o.open("GET",s),o.onreadystatechange=function(){4===o.readyState&&(o.status>=200&&o.status<300?e(o.responseText):(console.error("[error] Cannot load "+t),n(o.status)))},o.send(null)})},c.langProcessor={html:i,js:i,css:i},c.scriptExportsHandler=i,c});
